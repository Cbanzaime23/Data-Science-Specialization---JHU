las = 1)  # Set las parameter to 1 for horizontal labels
options(scipen = 0)
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
# plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
#      ylab = "Total Emission (PM2.5) in Tons in US",
#      xlab = "Year (from 1999 - 2008)",
#      main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
#      ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
options(scipen = 10)  # Disable scientific notation
# Set margins to provide space for y-axis tick labels
par(mar = c(5, 5, 4, 6))  # Adjust the values as needed
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in US",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1)  # Set las parameter to 1 for horizontal labels
options(scipen = 0)
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
# plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
#      ylab = "Total Emission (PM2.5) in Tons in US",
#      xlab = "Year (from 1999 - 2008)",
#      main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
#      ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
options(scipen = 10)  # Disable scientific notation
# Set margins to provide space for y-axis tick labels
par(mar = c(5, 15, 4, 6))  # Adjust the values as needed
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in US",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1)  # Set las parameter to 1 for horizontal labels
options(scipen = 0)
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
# plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
#      ylab = "Total Emission (PM2.5) in Tons in US",
#      xlab = "Year (from 1999 - 2008)",
#      main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
#      ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
options(scipen = 10)  # Disable scientific notation
# Set margins to provide space for y-axis tick labels
par(mar = c(5, 6, 4, 6))  # Adjust the values as needed
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in US",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1)  # Set las parameter to 1 for horizontal labels
options(scipen = 0)
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
# plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
#      ylab = "Total Emission (PM2.5) in Tons in US",
#      xlab = "Year (from 1999 - 2008)",
#      main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
#      ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
options(scipen = 10)  # Disable scientific notation
# Set up the layout to create more space for y-axis tick labels
layout(matrix(c(2, 1), nrow = 2), heights = c(1, 6))
# Create an empty plot in the first row to make space
plot.new()
# Create the main line plot in the second row
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "",  # Leave y-axis label empty here
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1)  # Set las parameter to 1 for horizontal labels
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
# plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
#      ylab = "Total Emission (PM2.5) in Tons in US",
#      xlab = "Year (from 1999 - 2008)",
#      main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
#      ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
options(scipen = 10)  # Disable scientific notation
# Set up the layout to create more space for y-axis tick labels
layout(matrix(c(2, 1), nrow = 2), heights = c(1, 3))
# Create an empty plot in the first row to make space
plot.new()
# Create the main line plot in the second row
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "",  # Leave y-axis label empty here
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1)  # Set las parameter to 1 for horizontal labels
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
# plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
#      ylab = "Total Emission (PM2.5) in Tons in US",
#      xlab = "Year (from 1999 - 2008)",
#      main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
#      ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
options(scipen = 10)  # Disable scientific notation
# Set up the layout to create more space for y-axis tick labels
layout(matrix(c(1, 1), nrow = 1), heights = c(1, 3))
# Create an empty plot in the first row to make space
plot.new()
# Create the main line plot in the second row
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "",  # Leave y-axis label empty here
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1)  # Set las parameter to 1 for horizontal labels
# Add y-axis label manually
par(mar = c(0, 4, 0, 0))  # Adjust left margin
text(0, 0.5, "Total Emission (PM2.5) in Tons in US",
srt = 90, adj = 0.5, xpd = TRUE)
options(scipen = 0)
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
# plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
#      ylab = "Total Emission (PM2.5) in Tons in US",
#      xlab = "Year (from 1999 - 2008)",
#      main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
#      ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
options(scipen = 10)  # Disable scientific notation
# Set up the layout to create more space for y-axis tick labels
layout(matrix(c(2, 1), nrow = 1), heights = c(1, 3))
# Create an empty plot in the first row to make space
plot.new()
# Create the main line plot in the second row
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "",  # Leave y-axis label empty here
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1)  # Set las parameter to 1 for horizontal labels
# Add y-axis label manually
par(mar = c(0, 4, 0, 0))  # Adjust left margin
text(0, 0.5, "Total Emission (PM2.5) in Tons in US",
srt = 90, adj = 0.5, xpd = TRUE)
options(scipen = 0)
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
# plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
#      ylab = "Total Emission (PM2.5) in Tons in US",
#      xlab = "Year (from 1999 - 2008)",
#      main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
#      ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
options(scipen = 10)  # Disable scientific notation
# Set up the layout to create more space for y-axis tick labels
layout(matrix(c(1, 2), nrow = 1), heights = c(1, 3))
# Create an empty plot in the first row to make space
plot.new()
# Create the main line plot in the second row
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "",  # Leave y-axis label empty here
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1)  # Set las parameter to 1 for horizontal labels
# Add y-axis label manually
par(mar = c(0, 4, 0, 0))  # Adjust left margin
text(0, 0.5, "Total Emission (PM2.5) in Tons in US",
srt = 90, adj = 0.5, xpd = TRUE)
options(scipen = 0)
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
# plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
#      ylab = "Total Emission (PM2.5) in Tons in US",
#      xlab = "Year (from 1999 - 2008)",
#      main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
#      ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
options(scipen = 10)  # Disable scientific notation
# Set up the layout to create more space for y-axis tick labels
#layout(matrix(c(1, 2), nrow = 1), heights = c(1, 3))
# Create an empty plot in the first row to make space
plot.new()
# Create the main line plot in the second row
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "",  # Leave y-axis label empty here
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1)  # Set las parameter to 1 for horizontal labels
# Add y-axis label manually
par(mar = c(0, 4, 0, 0))  # Adjust left margin
text(0, 0.5, "Total Emission (PM2.5) in Tons in US",
srt = 90, adj = 0.5, xpd = TRUE)
options(scipen = 0)
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
# plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
#      ylab = "Total Emission (PM2.5) in Tons in US",
#      xlab = "Year (from 1999 - 2008)",
#      main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
#      ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
options(scipen = 10)  # Disable scientific notation
# Set up the layout to create more space for y-axis tick labels
layout(matrix(c(2, 1), nrow = 2), heights = c(1, 3))
# Create an empty plot in the first row to make space
plot.new()
# Create the main line plot in the second row
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "",  # Leave y-axis label empty here
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1)  # Set las parameter to 1 for horizontal labels
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in US",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in US",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1),
las = 1) # Set the minimum y value to 0
#Using Base Plotting System in R
# Plot the Total Emission per Year
# png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in US",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
#Using Base Plotting System in R
# Plot the Total Emission per Year
png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in US",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
library(dplyr)
# Get the directory where the R script is located
script_directory <- dirname(rstudioapi::getSourceEditorContext()$path)
# Set the working directory to the script's directory
setwd(script_directory)
## This first line will likely take a few seconds. Be patient!
NEI <- readRDS("./Data/summarySCC_PM25.rds")
SCC <- readRDS("./Data/Source_Classification_Code.rds")
dev.off()
dev.off()
dev.off()
library(dplyr)
# Get the directory where the R script is located
script_directory <- dirname(rstudioapi::getSourceEditorContext()$path)
# Set the working directory to the script's directory
setwd(script_directory)
## This first line will likely take a few seconds. Be patient!
NEI <- readRDS("./Data/summarySCC_PM25.rds")
SCC <- readRDS("./Data/Source_Classification_Code.rds")
library(dplyr)
# Get the directory where the R script is located
script_directory <- dirname(rstudioapi::getSourceEditorContext()$path)
# Set the working directory to the script's directory
setwd(script_directory)
## This first line will likely take a few seconds. Be patient!
NEI <- readRDS("./Data/summarySCC_PM25.rds")
SCC <- readRDS("./Data/Source_Classification_Code.rds")
library(dplyr)
# Get the directory where the R script is located
script_directory <- dirname(rstudioapi::getSourceEditorContext()$path)
# Set the working directory to the script's directory
setwd(script_directory)
## This first line will likely take a few seconds. Be patient!
NEI <- readRDS("./Data/summarySCC_PM25.rds")
SCC <- readRDS("./Data/Source_Classification_Code.rds")
#Using Base Plotting System in R
# Plot the Total Emission per Year
png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in US",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
#dev.off()
#Using Base Plotting System in R
# Plot the Total Emission per Year
png(file = "./Plots/plot1.png", width = 800, height = 600, units = "px", pointsize = 12)
df_grp_year_sum <- aggregate(Emissions ~ year, data = NEI, FUN = sum)
plot(df_grp_year_sum$year, df_grp_year_sum$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in US",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 decreased (close to 50% reduction)\n in the US  from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum$Emissions) * 1.1)) # Set the minimum y value to 0
#dev.off()
# png(file = "plot3.png", width = 800, height = 600, units = "px", pointsize = 12)
NEI_24510 <- filter(NEI,fips == "24510")
#df_grp_year_sum_24510 <- aggregate(Emissions ~ year, data = NEI_24510, FUN = sum)
df_grp_year_type_sum_24510 = NEI_24510 %>% group_by(year, type)  %>%
summarise(total_Emissions = sum(Emissions),
.groups = 'drop')
ggplot(df_grp_year_type_sum,
aes(x = year, y = total_Emissions, group = type, color = type)) +
geom_line(size = 1) +
xlab("Year (from 1999 - 2008)") +
ylab("Total Emission (PM2.5) in Tons") +
scale_color_manual(values = c("red", "black", "blue", "purple")) +
ggtitle("NONPOINT, NON-ROAD and ON-ROAD are all have decreasing \nEmission Trend from 1999-2008 but for the POINT, there is a increasing \nTrend from 1999-2005 and decreasing from 2005-2008") +
theme(plot.title = element_text(hjust = 0.5, vjust = 0.5, face = "bold"))
# png(file = "plot2.png", width = 800, height = 600, units = "px", pointsize = 12)
NEI_24510 <- filter(NEI,fips == "24510")
df_grp_year_sum_24510 <- aggregate(Emissions ~ year, data = NEI_24510, FUN = sum)
plot(df_grp_year_sum_24510$year, df_grp_year_sum_24510$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in Baltimore City(fips == 24510)",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 also decreased \n in the Baltimore City, Maryland from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum_24510$Emissions) * 1.1)) # Set the minimum y value to 0
#
# dev.off()
# png(file = "plot2.png", width = 800, height = 600, units = "px", pointsize = 12)
NEI_24510 <- filter(NEI,fips == "24510")
df_grp_year_sum_24510 <- aggregate(Emissions ~ year, data = NEI_24510, FUN = sum)
plot(df_grp_year_sum_24510$year, df_grp_year_sum_24510$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons \n in Baltimore City(fips == 24510)",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 also decreased \n in the Baltimore City, Maryland from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum_24510$Emissions) * 1.1)) # Set the minimum y value to 0
#
# dev.off()
# png(file = "plot2.png", width = 800, height = 600, units = "px", pointsize = 12)
NEI_24510 <- filter(NEI,fips == "24510")
df_grp_year_sum_24510 <- aggregate(Emissions ~ year, data = NEI_24510, FUN = sum)
plot(df_grp_year_sum_24510$year, df_grp_year_sum_24510$Emissions, type = "l",
ylab = "Total Emission (PM2.5) in Tons in Baltimore City(fips == 24510)",
xlab = "Year (from 1999 - 2008)",
main = "Yes, Total Emission from PM2.5 also decreased \n in the Baltimore City, Maryland from 1999 to 2008",
ylim = c(0, max(df_grp_year_sum_24510$Emissions) * 1.1)) # Set the minimum y value to 0
#
# dev.off()
# png(file = "plot3.png", width = 800, height = 600, units = "px", pointsize = 12)
NEI_24510 <- filter(NEI,fips == "24510")
#df_grp_year_sum_24510 <- aggregate(Emissions ~ year, data = NEI_24510, FUN = sum)
df_grp_year_type_sum_24510 = NEI_24510 %>% group_by(year, type)  %>%
summarise(total_Emissions = sum(Emissions),
.groups = 'drop')
ggplot(df_grp_year_type_sum,
aes(x = year, y = total_Emissions, group = type, color = type)) +
geom_line(size = 1) +
xlab("Year (from 1999 - 2008)") +
ylab("Total Emission (PM2.5) in Tons") +
scale_color_manual(values = c("red", "black", "blue", "purple")) +
ggtitle("NONPOINT, NON-ROAD and ON-ROAD are all have decreasing \nEmission Trend from 1999-2008 but for the POINT, there is a increasing \nTrend from 1999-2005 and decreasing from 2005-2008") +
theme(plot.title = element_text(hjust = 0.5, vjust = 0.5, face = "bold"))
library(dplyr)
library(ggplot2)
# Get the directory where the R script is located
script_directory <- dirname(rstudioapi::getSourceEditorContext()$path)
# Set the working directory to the script's directory
setwd(script_directory)
## This first line will likely take a few seconds. Be patient!
NEI <- readRDS("./Data/summarySCC_PM25.rds")
SCC <- readRDS("./Data/Source_Classification_Code.rds")
library("ggplot")
library("ggplot2")
library("dplyr")
library("ggplot2")
# Get the directory where the R script is located
script_directory <- dirname(rstudioapi::getSourceEditorContext()$path)
# Set the working directory to the script's directory
setwd(script_directory)
## This first line will likely take a few seconds. Be patient!
NEI <- readRDS("./Data/summarySCC_PM25.rds")
SCC <- readRDS("./Data/Source_Classification_Code.rds")
# png(file = "plot3.png", width = 800, height = 600, units = "px", pointsize = 12)
NEI_24510 <- filter(NEI,fips == "24510")
#df_grp_year_sum_24510 <- aggregate(Emissions ~ year, data = NEI_24510, FUN = sum)
df_grp_year_type_sum_24510 = NEI_24510 %>% group_by(year, type)  %>%
summarise(total_Emissions = sum(Emissions),
.groups = 'drop')
ggplot(df_grp_year_type_sum,
aes(x = year, y = total_Emissions, group = type, color = type)) +
geom_line(size = 1) +
xlab("Year (from 1999 - 2008)") +
ylab("Total Emission (PM2.5) in Tons") +
scale_color_manual(values = c("red", "black", "blue", "purple")) +
ggtitle("NONPOINT, NON-ROAD and ON-ROAD are all have decreasing \nEmission Trend from 1999-2008 but for the POINT, there is a increasing \nTrend from 1999-2005 and decreasing from 2005-2008") +
theme(plot.title = element_text(hjust = 0.5, vjust = 0.5, face = "bold"))
# png(file = "plot3.png", width = 800, height = 600, units = "px", pointsize = 12)
NEI_24510 <- filter(NEI,fips == "24510")
#df_grp_year_sum_24510 <- aggregate(Emissions ~ year, data = NEI_24510, FUN = sum)
df_grp_year_type_sum_24510 = NEI_24510 %>% group_by(year, type)  %>%
summarise(total_Emissions = sum(Emissions),
.groups = 'drop')
ggplot(df_grp_year_type_sum_24510,
aes(x = year, y = total_Emissions, group = type, color = type)) +
geom_line(size = 1) +
xlab("Year (from 1999 - 2008)") +
ylab("Total Emission (PM2.5) in Tons") +
scale_color_manual(values = c("red", "black", "blue", "purple")) +
ggtitle("NONPOINT, NON-ROAD and ON-ROAD are all have decreasing \nEmission Trend from 1999-2008 but for the POINT, there is a increasing \nTrend from 1999-2005 and decreasing from 2005-2008") +
theme(plot.title = element_text(hjust = 0.5, vjust = 0.5, face = "bold"))
# dev.off()
# png(file = "plot4.png", width = 800, height = 600, units = "px", pointsize = 12)
merged_NEI_SCC <- left_join(NEI, SCC, by = "SCC")
#View(merged_NEI_SCC[grepl("Coal", merged_NEI_SCC$Short.Name), ])
merged_NEI_SCC_Coal <- merged_NEI_SCC[grepl("Coal", merged_NEI_SCC$Short.Name), ]
merged_NEI_SCC_Coal_grp_year_sum = merged_NEI_SCC_Coal %>% group_by(year)  %>%
summarise(total_Emissions = sum(Emissions),
.groups = 'drop')
ggplot(merged_NEI_SCC_Coal_grp_year_sum, aes(x=year, y=total_Emissions)) +
geom_line(size = 1) +
ylab("Total Emission (PM2.5) in Tons") +
xlab("Year (from 1999 - 2008)") +
labs(title = "Coal Combustion-Related Sources of PM2.5: There is a decrease \n from 1998 to 2002, slight increase from 2002 to 2005 and \nsignificant decrease from 2005 to 2008") + # add a chart title
theme(plot.title = element_text(hjust = 0.5, vjust = 0.5, face = "bold"))  + # center the title horizontally and vertically
# Customize y-axis
scale_y_continuous(labels = comma,
limits = c(0, max(merged_NEI_SCC_Coal_grp_year_sum$total_Emissions) * 1.1), # set the maximum limit 10% higher than the max value of y
expand = c(0, 0.05)) # remove white space at the top of the chart
# png(file = "plot4.png", width = 800, height = 600, units = "px", pointsize = 12)
merged_NEI_SCC <- left_join(NEI, SCC, by = "SCC")
#View(merged_NEI_SCC[grepl("Coal", merged_NEI_SCC$Short.Name), ])
merged_NEI_SCC_Coal <- merged_NEI_SCC[grepl("Coal", merged_NEI_SCC$Short.Name), ]
merged_NEI_SCC_Coal_grp_year_sum = merged_NEI_SCC_Coal %>% group_by(year)  %>%
summarise(total_Emissions = sum(Emissions),
.groups = 'drop')
ggplot(merged_NEI_SCC_Coal_grp_year_sum, aes(x=year, y=total_Emissions)) +
geom_line(size = 1) +
ylab("Total Emission (PM2.5) in Tons") +
xlab("Year (from 1999 - 2008)") +
labs(title = "Coal Combustion-Related Sources of PM2.5: There is a decrease \n from 1998 to 2002, slight increase from 2002 to 2005 and \nsignificant decrease from 2005 to 2008") + # add a chart title
theme(plot.title = element_text(hjust = 0.5, vjust = 0.5, face = "bold"))  + # center the title horizontally and vertically
# Customize y-axis
scale_y_continuous(
# labels = comma,
limits = c(0, max(merged_NEI_SCC_Coal_grp_year_sum$total_Emissions) * 1.1), # set the maximum limit 10% higher than the max value of y
expand = c(0, 0.05)) # remove white space at the top of the chart
# dev.off()
# png(file = "plot5.png", width = 800, height = 600, units = "px", pointsize = 12)
merged_NEI_SCC <- left_join(NEI, SCC, by = "SCC")
merged_NEI_SCC_24510 <- filter(merged_NEI_SCC,fips == "24510")
merged_NEI_SCC_24510_Motor <- merged_NEI_SCC_24510[grepl("Vehicles|Motor", merged_NEI_SCC_24510$Short.Name), ]
merged_NEI_SCC_24510_Motor_grp_year_sum = merged_NEI_SCC_24510_Motor %>% group_by(year)  %>%
summarise(total_Emissions = sum(Emissions),
.groups = 'drop')
ggplot(merged_NEI_SCC_24510_Motor_grp_year_sum, aes(x=year, y=total_Emissions)) +
geom_line(size = 1) +
ylab("Total Emission (PM2.5) in Tons") +
xlab("Year (from 1999 - 2008)") +
labs(title = "Motor Vehicle Sources of PM2.5 in Baltimore City: Significant \ndecrease from 1998 to 2002, slight decrease from 2002 to 2008") + # add a chart title
theme(plot.title = element_text(hjust = 0.5, vjust = 0.5, face = "bold"))  + # center the title horizontally and vertically
# Customize y-axis
scale_y_continuous(labels = comma,
limits = c(0, max(merged_NEI_SCC_24510_Motor_grp_year_sum$total_Emissions) * 1.1), # set the maximum limit 10% higher than the max value of y
expand = c(0, 0.05)) # remove white space at the top of the chart
# png(file = "plot5.png", width = 800, height = 600, units = "px", pointsize = 12)
merged_NEI_SCC <- left_join(NEI, SCC, by = "SCC")
merged_NEI_SCC_24510 <- filter(merged_NEI_SCC,fips == "24510")
merged_NEI_SCC_24510_Motor <- merged_NEI_SCC_24510[grepl("Vehicles|Motor", merged_NEI_SCC_24510$Short.Name), ]
merged_NEI_SCC_24510_Motor_grp_year_sum = merged_NEI_SCC_24510_Motor %>% group_by(year)  %>%
summarise(total_Emissions = sum(Emissions),
.groups = 'drop')
ggplot(merged_NEI_SCC_24510_Motor_grp_year_sum, aes(x=year, y=total_Emissions)) +
geom_line(size = 1) +
ylab("Total Emission (PM2.5) in Tons") +
xlab("Year (from 1999 - 2008)") +
labs(title = "Motor Vehicle Sources of PM2.5 in Baltimore City: Significant \ndecrease from 1998 to 2002, slight decrease from 2002 to 2008") + # add a chart title
theme(plot.title = element_text(hjust = 0.5, vjust = 0.5, face = "bold"))  + # center the title horizontally and vertically
# Customize y-axis
scale_y_continuous(
# labels = comma,
limits = c(0, max(merged_NEI_SCC_24510_Motor_grp_year_sum$total_Emissions) * 1.1), # set the maximum limit 10% higher than the max value of y
expand = c(0, 0.05)) # remove white space at the top of the chart
# dev.off()
# png(file = "plot6.png", width = 800, height = 600, units = "px", pointsize = 12)
merged_NEI_SCC_Motor <- merged_NEI_SCC[grepl("Vehicles|Motor", merged_NEI_SCC$Short.Name), ]
merged_NEI_SCC_Motor_06037_24510 <- merged_NEI_SCC_Motor[grepl("06037|24510", merged_NEI_SCC_Motor$fips), ]
merged_NEI_SCC_Motor_06037_24510_year_sum = merged_NEI_SCC_Motor_06037_24510 %>% group_by(year, fips)  %>%
summarise(total_Emissions = sum(Emissions),
.groups = 'drop')
ggplot(merged_NEI_SCC_Motor_06037_24510_year_sum,
aes(x = year, y = total_Emissions, group = fips, color = fips)) +
geom_line(size = 1) +
xlab("Year (from 1999 - 2008)") +
ylab("Total Emission (PM2.5) in Tons") +
scale_color_manual(values = c("red", "blue")) +
ggtitle("Motor Vehicle Sources of PM2.5: Baltimore City (24510) and \nLos Angeles City (06037) are both have decreasing Total \n Emission Trend from 1999-2008 but for the Los Angeles City , \n the Decreasing Trend is more significant") +
theme(plot.title = element_text(hjust = 0.5, vjust = 0.5, face = "bold"))
# dev.off()
